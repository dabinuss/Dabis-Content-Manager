<UserControl x:Class="DCM.App.Views.PresetsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:core="clr-namespace:DCM.Core.Models;assembly=DCM.Core"
             xmlns:ap="clr-namespace:DCM.App.Infrastructure.AttachedProperties">
  <Grid Margin="0,0,8,0">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="320"/>
      <ColumnDefinition Width="{StaticResource SpacingL}"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <Border Grid.Column="1"
            Background="{StaticResource BorderBrush}"
            Width="1"
            VerticalAlignment="Stretch"
            HorizontalAlignment="Center"
            Margin="0,8"
            SnapsToDevicePixels="True"/>

    <Grid Grid.Column="0"
          Margin="8,8,0,8">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="{StaticResource SpacingS}"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="{StaticResource SpacingS}"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>

      <WrapPanel Grid.Row="0"
                 VerticalAlignment="Top"
                 Margin="0,0,8,0">
        <Button Content="{DynamicResource Common.Add}"
                Style="{StaticResource SecondaryButton}"
                ap:ButtonIcon.Glyph="&#xe145;"
                Click="PresetNewButton_Click"
                Margin="0,0,8,8"
                MinWidth="96"/>
        <Button Content="{DynamicResource Common.Edit}"
                Style="{StaticResource SecondaryButton}"
                ap:ButtonIcon.Glyph="&#xe3c9;"
                Click="PresetEditButton_Click"
                Margin="0,0,8,8"
                MinWidth="96"/>
        <Button Content="{DynamicResource Common.Delete}"
                Style="{StaticResource DangerButton}"
                ap:ButtonIcon.Glyph="&#xe872;"
                Click="PresetDeleteButton_Click"
                Margin="0,0,8,8"
                MinWidth="96"/>
        <Button Content="{DynamicResource Common.Save}"
                Style="{StaticResource PrimaryButton}"
                ap:ButtonIcon.Glyph="&#xe161;"
                Click="PresetSaveButton_Click"
                Margin="0,0,8,8"
                MinWidth="96"/>
      </WrapPanel>

      <TextBlock Grid.Row="2"
                 Text="{DynamicResource Presets.Header}"
                 Style="{StaticResource SectionHeader}"
                 Margin="0,0,8,0"/>

      <Border Grid.Row="4"
              Padding="0">
        <ListBox x:Name="PresetListBox"
                 ScrollViewer.CanContentScroll="True"
                 VirtualizingStackPanel.IsVirtualizing="True"
                 VirtualizingStackPanel.VirtualizationMode="Recycling"
                 SelectionChanged="PresetListBox_SelectionChanged">
          <ListBox.ItemContainerStyle>
            <Style TargetType="ListBoxItem">
              <Setter Property="Margin"
                      Value="0,0,0,8"/>
              <Setter Property="Padding"
                      Value="0"/>
              <Setter Property="HorizontalContentAlignment"
                      Value="Stretch"/>
              <Setter Property="Background"
                      Value="Transparent"/>
              <Setter Property="BorderThickness"
                      Value="0"/>
              <Setter Property="FocusVisualStyle"
                      Value="{x:Null}"/>
              <Setter Property="SnapsToDevicePixels"
                      Value="True"/>
              <Setter Property="Template">
                <Setter.Value>
                  <ControlTemplate TargetType="ListBoxItem">
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="True">
                      <ContentPresenter Margin="{TemplateBinding Padding}"
                                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    </Border>
                  </ControlTemplate>
                </Setter.Value>
              </Setter>
            </Style>
          </ListBox.ItemContainerStyle>
          <ListBox.ItemTemplate>
            <DataTemplate>
              <Border Padding="8,8,6,8">
                <Border.Style>
                  <Style TargetType="Border">
                    <Setter Property="Background"
                            Value="{StaticResource SurfaceElevatedBrush}"/>
                    <Setter Property="BorderBrush"
                            Value="{StaticResource BorderBrush}"/>
                    <Setter Property="CornerRadius"
                            Value="{StaticResource RadiusS}"/>
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsMouseOver}"
                                   Value="True">
                        <Setter Property="Background"
                                Value="{StaticResource SurfaceHoverBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource BorderHoverBrush}"/>
                      </DataTrigger>
                      <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsSelected}"
                                   Value="True">
                        <Setter Property="Background"
                                Value="{StaticResource SurfacePressedBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource BorderStrongBrush}"/>
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </Border.Style>
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="{Binding Name}"
                             FontSize="{StaticResource FontSizeS}"
                             Foreground="{StaticResource TextPrimaryBrush}"
                             TextTrimming="CharacterEllipsis"
                             VerticalAlignment="Center"/>
                  <Button Grid.Column="1"
                          Padding="0"
                          Margin="8,0,0,0"
                          Background="Transparent"
                          BorderThickness="0"
                          Focusable="False"
                          IsTabStop="False"
                          CommandParameter="{Binding}"
                          PreviewMouseLeftButtonDown="PresetDefaultToggleButton_PreviewMouseLeftButtonDown"
                          Click="PresetDefaultToggleButton_Click">
                    <Border Padding="6,2"
                            CornerRadius="{StaticResource RadiusS}"
                            Background="{StaticResource SurfaceHoverBrush}"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            VerticalAlignment="Center">
                      <Border.Style>
                        <Style TargetType="Border">
                          <Setter Property="Opacity"
                                  Value="0.5"/>
                          <Style.Triggers>
                            <DataTrigger Binding="{Binding IsDefault}"
                                         Value="True">
                              <Setter Property="Opacity"
                                      Value="1"/>
                              <Setter Property="BorderBrush"
                                      Value="{StaticResource BorderStrongBrush}"/>
                            </DataTrigger>
                          </Style.Triggers>
                        </Style>
                      </Border.Style>
                      <StackPanel Orientation="Horizontal">
                        <TextBlock FontFamily="{StaticResource MaterialIconsFont}"
                                   FontSize="14"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="0,0,4,0">
                          <TextBlock.Style>
                            <Style TargetType="TextBlock">
                              <Setter Property="Text"
                                      Value="&#xe83a;"/>
                              <Style.Triggers>
                                <DataTrigger Binding="{Binding IsDefault}"
                                             Value="True">
                                  <Setter Property="Text"
                                          Value="&#xe838;"/>
                                </DataTrigger>
                              </Style.Triggers>
                            </Style>
                          </TextBlock.Style>
                        </TextBlock>
                        <TextBlock Text="{DynamicResource Presets.Badge.Default}"
                                   FontSize="{StaticResource FontSizeXS}"
                                   Foreground="{StaticResource TextSecondaryBrush}">
                          <TextBlock.Style>
                            <Style TargetType="TextBlock">
                              <Setter Property="Visibility"
                                      Value="Collapsed"/>
                              <Style.Triggers>
                                <DataTrigger Binding="{Binding IsDefault}"
                                             Value="True">
                                  <Setter Property="Visibility"
                                          Value="Visible"/>
                                </DataTrigger>
                              </Style.Triggers>
                            </Style>
                          </TextBlock.Style>
                        </TextBlock>
                      </StackPanel>
                    </Border>
                  </Button>
                </Grid>
              </Border>
            </DataTemplate>
          </ListBox.ItemTemplate>
        </ListBox>
      </Border>
    </Grid>

    <Grid Grid.Column="2"
          Margin="8,8,8,8">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="{StaticResource SpacingM}"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>

      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <TextBlock Text="{DynamicResource Presets.Edit}"
                   Style="{StaticResource SectionHeader}"/>
        <Border x:Name="PresetDirtyBadge"
                Grid.Column="1"
                Padding="6,2"
                Margin="8,0,0,0"
                CornerRadius="{StaticResource RadiusS}"
                Background="{StaticResource SurfaceHoverBrush}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="1"
                VerticalAlignment="Center"
                Visibility="Collapsed">
          <StackPanel Orientation="Horizontal">
            <TextBlock FontFamily="{StaticResource MaterialIconsFont}"
                       Text="&#xe001;"
                       FontSize="14"
                       Foreground="{StaticResource TextSecondaryBrush}"
                       Margin="0,0,4,0"/>
            <TextBlock Text="{DynamicResource Presets.Badge.Unsaved}"
                       FontSize="{StaticResource FontSizeXS}"
                       Foreground="{StaticResource TextSecondaryBrush}"/>
          </StackPanel>
        </Border>
      </Grid>

      <ScrollViewer Grid.Row="2"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Disabled">
        <Grid>
          <Grid x:Name="PresetEditorGrid">
          <Grid.Style>
            <Style TargetType="Grid">
              <Setter Property="IsEnabled"
                      Value="True"/>
              <Setter Property="Opacity"
                      Value="1"/>
              <Setter Property="Visibility"
                      Value="Visible"/>
              <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=PresetListBox, Path=Items.Count}"
                             Value="0">
                  <Setter Property="Visibility"
                          Value="Collapsed"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=PresetListBox, Path=SelectedItem}"
                             Value="{x:Null}">
                  <Setter Property="IsEnabled"
                          Value="False"/>
                  <Setter Property="Opacity"
                          Value="0.6"/>
                </DataTrigger>
              </Style.Triggers>
            </Style>
          </Grid.Style>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="{StaticResource SpacingL}"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="{StaticResource SpacingM}"/>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="{StaticResource SpacingM}"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <GroupBox Header="{DynamicResource Presets.Section.Info}"
                  Grid.Row="0"
                  Grid.Column="0"
                  Grid.ColumnSpan="3"
                  Padding="12">
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="140"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="{StaticResource SpacingS}"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="{StaticResource SpacingS}"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Label Content="{DynamicResource Presets.Fields.Name}"
                   Grid.Row="0"
                   Grid.Column="0"/>
            <TextBox x:Name="PresetNameTextBox"
                     Grid.Row="0"
                     Grid.Column="1"
                     TextChanged="PresetEditorField_Changed"/>

            <Label Content="{DynamicResource Presets.Fields.Platform}"
                   Grid.Row="2"
                   Grid.Column="0"/>
            <ComboBox x:Name="PresetPlatformComboBox"
                      Grid.Row="2"
                      Grid.Column="1"
                      HorizontalAlignment="Left"
                      MinWidth="150"
                      SelectionChanged="PresetEditorField_Changed"/>

            <Label Content="{DynamicResource Presets.Fields.Notes}"
                   Grid.Row="4"
                   Grid.Column="0"/>
            <TextBox x:Name="PresetDescriptionTextBox"
                     Grid.Row="4"
                     Grid.Column="1"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     Height="60"
                     TextChanged="PresetEditorField_Changed"
                     VerticalScrollBarVisibility="Auto"/>
          </Grid>
        </GroupBox>

        <GroupBox Header="{DynamicResource Presets.Section.Basic}"
                  Grid.Row="2"
                  Grid.Column="0"
                  Padding="12">
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="140"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="{StaticResource SpacingS}"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Label Content="{DynamicResource Presets.Fields.TitlePrefix}"
                   Grid.Row="0"
                   Grid.Column="0"/>
            <TextBox x:Name="PresetTitlePrefixTextBox"
                     Grid.Row="0"
                     Grid.Column="1"
                     TextChanged="PresetEditorField_Changed"/>

            <Label Content="{DynamicResource Presets.Fields.Tags}"
                   Grid.Row="2"
                   Grid.Column="0"/>
            <TextBox x:Name="PresetTagsTextBox"
                     Grid.Row="2"
                     Grid.Column="1"
                     TextChanged="PresetEditorField_Changed"/>
          </Grid>
        </GroupBox>

        <GroupBox Header="{DynamicResource Presets.Section.Publishing}"
                  Grid.Row="2"
                  Grid.Column="2"
                  Padding="12">
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="140"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="{StaticResource SpacingS}"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="{StaticResource SpacingS}"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="{StaticResource SpacingS}"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="{StaticResource SpacingS}"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="{StaticResource SpacingS}"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Label Content="{DynamicResource Presets.Fields.Visibility}"
                   Grid.Row="0"
                   Grid.Column="0"/>
            <ComboBox x:Name="PresetVisibilityComboBox"
                      Grid.Row="0"
                      Grid.Column="1"
                      HorizontalAlignment="Left"
                      MinWidth="180"
                      SelectionChanged="PresetEditorField_Changed">
              <ComboBoxItem Content="{DynamicResource Upload.Fields.Visibility.Public}"
                            Tag="{x:Static core:VideoVisibility.Public}"/>
              <ComboBoxItem Content="{DynamicResource Upload.Fields.Visibility.Unlisted}"
                            Tag="{x:Static core:VideoVisibility.Unlisted}"/>
              <ComboBoxItem Content="{DynamicResource Upload.Fields.Visibility.Private}"
                            Tag="{x:Static core:VideoVisibility.Private}"/>
            </ComboBox>

            <Label Content="{DynamicResource Presets.Fields.Playlist}"
                   Grid.Row="2"
                   Grid.Column="0"/>
            <ComboBox x:Name="PresetPlaylistComboBox"
                      Grid.Row="2"
                      Grid.Column="1"
                      DisplayMemberPath="Title"
                      SelectionChanged="PresetEditorField_Changed"/>

            <Label Content="{DynamicResource Presets.Fields.Category}"
                   Grid.Row="4"
                   Grid.Column="0"/>
            <ComboBox x:Name="PresetCategoryComboBox"
                      Grid.Row="4"
                      Grid.Column="1"
                      DisplayMemberPath="DisplayName"
                      SelectionChanged="PresetEditorField_Changed"/>

            <Label Content="{DynamicResource Presets.Fields.Language}"
                   Grid.Row="6"
                   Grid.Column="0"/>
            <ComboBox x:Name="PresetLanguageComboBox"
                      Grid.Row="6"
                      Grid.Column="1"
                      DisplayMemberPath="DisplayName"
                      SelectionChanged="PresetEditorField_Changed"/>

            <Label Content="{DynamicResource Presets.Fields.MadeForKids}"
                   Grid.Row="8"
                   Grid.Column="0"/>
            <ComboBox x:Name="PresetMadeForKidsComboBox"
                      Grid.Row="8"
                      Grid.Column="1"
                      HorizontalAlignment="Left"
                      MinWidth="180"
                      SelectionChanged="PresetEditorField_Changed">
              <ComboBoxItem Content="{DynamicResource Presets.Fields.MadeForKids.Default}"
                            Tag="{x:Static core:MadeForKidsSetting.Default}"
                            IsSelected="True"/>
              <ComboBoxItem Content="{DynamicResource Presets.Fields.MadeForKids.Yes}"
                            Tag="{x:Static core:MadeForKidsSetting.Yes}"/>
              <ComboBoxItem Content="{DynamicResource Presets.Fields.MadeForKids.No}"
                            Tag="{x:Static core:MadeForKidsSetting.No}"/>
            </ComboBox>

            <Label Content="{DynamicResource Presets.Fields.CommentStatus}"
                   Grid.Row="10"
                   Grid.Column="0"/>
            <ComboBox x:Name="PresetCommentStatusComboBox"
                      Grid.Row="10"
                      Grid.Column="1"
                      HorizontalAlignment="Left"
                      MinWidth="180"
                      SelectionChanged="PresetEditorField_Changed">
              <ComboBoxItem Content="{DynamicResource Presets.Fields.CommentStatus.Default}"
                            Tag="{x:Static core:CommentStatusSetting.Default}"
                            IsSelected="True"/>
              <ComboBoxItem Content="{DynamicResource Presets.Fields.CommentStatus.Enabled}"
                            Tag="{x:Static core:CommentStatusSetting.Enabled}"/>
              <ComboBoxItem Content="{DynamicResource Presets.Fields.CommentStatus.Disabled}"
                            Tag="{x:Static core:CommentStatusSetting.Disabled}"/>
            </ComboBox>
          </Grid>
        </GroupBox>

        <GroupBox Header="{DynamicResource Presets.Section.Template}"
                  Grid.Row="4"
                  Grid.Column="0"
                  Grid.ColumnSpan="3"
                  Padding="12">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="{StaticResource SpacingS}"/>
              <RowDefinition Height="*"/>
              <RowDefinition Height="{StaticResource SpacingM}"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0"
                       Text="{DynamicResource Presets.Fields.TemplateBody}"
                       Foreground="{StaticResource TextMutedBrush}"
                       FontSize="{StaticResource FontSizeM}"/>
            <TextBox x:Name="PresetDescriptionTemplateTextBox"
                     Grid.Row="2"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     MinHeight="96"
                     TextChanged="PresetEditorField_Changed"
                     VerticalScrollBarVisibility="Auto"/>

            <Grid Grid.Row="4">
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="{StaticResource SpacingS}"/>
                <RowDefinition Height="Auto"/>
              </Grid.RowDefinitions>
              <TextBlock Grid.Row="0"
                         Text="{DynamicResource Presets.Placeholders.Insert}"
                         FontSize="{StaticResource FontSizeS}"
                         Foreground="{StaticResource TextMutedBrush}"/>
              <ItemsControl x:Name="PlaceholderItemsControl"
                            Grid.Row="2">
                <ItemsControl.ItemsPanel>
                  <ItemsPanelTemplate>
                    <WrapPanel />
                  </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <Button Content="{Binding}"
                            Margin="0,0,8,8"
                            Style="{StaticResource SecondaryButton}"
                            ap:ButtonIcon.Glyph="&#xe892;"
                            Padding="8,8"
                            Click="PlaceholderButton_Click"/>
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
            </Grid>
          </Grid>
        </GroupBox>
        </Grid>

        <Border x:Name="PresetEmptyState"
                Grid.Row="0"
                Grid.RowSpan="5"
                Grid.Column="0"
                Grid.ColumnSpan="3"
                Background="Transparent">
          <Border.Style>
            <Style TargetType="Border">
              <Setter Property="Visibility"
                      Value="Collapsed"/>
              <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=PresetListBox, Path=Items.Count}"
                             Value="0">
                  <Setter Property="Visibility"
                          Value="Visible"/>
                </DataTrigger>
              </Style.Triggers>
            </Style>
          </Border.Style>
          <Grid MinHeight="360"
                VerticalAlignment="Stretch"
                HorizontalAlignment="Stretch">
            <Grid.RowDefinitions>
              <RowDefinition Height="*"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="2*"/>
            </Grid.RowDefinitions>
            <StackPanel Grid.Row="1"
                        HorizontalAlignment="Center"
                        Margin="32">
              <TextBlock Style="{StaticResource Icon}"
                         Text="&#xe8b8;"
                         FontSize="{StaticResource FontSizeXXXXL}"
                         Foreground="{StaticResource TextMutedBrush}"
                         HorizontalAlignment="Center"
                         Margin="0,0,0,24"/>
              <TextBlock Text="{DynamicResource Presets.Empty.Title}"
                         FontSize="{StaticResource FontSizeXXL}"
                         FontWeight="SemiBold"
                         Foreground="{StaticResource TextPrimaryBrush}"
                         HorizontalAlignment="Center"/>
              <TextBlock Text="{DynamicResource Presets.Empty.Subtitle}"
                         FontSize="{StaticResource FontSizeM}"
                         Foreground="{StaticResource TextMutedBrush}"
                         HorizontalAlignment="Center"
                         Margin="0,12,0,0"/>
              <Button Content="{DynamicResource Presets.Empty.Action}"
                      Style="{StaticResource PrimaryButton}"
                      ap:ButtonIcon.Glyph="&#xe145;"
                      Click="PresetNewButton_Click"
                      Margin="0,16,0,0"
                      HorizontalAlignment="Center"/>
            </StackPanel>
          </Grid>
        </Border>
      </Grid>
      </ScrollViewer>
    </Grid>
  </Grid>
</UserControl>
