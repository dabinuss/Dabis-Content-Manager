<UserControl x:Class="DCM.App.Views.HistoryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:core="clr-namespace:DCM.Core.Models;assembly=DCM.Core"
             xmlns:config="clr-namespace:DCM.Core.Configuration;assembly=DCM.Core"
             xmlns:ap="clr-namespace:DCM.App.Infrastructure.AttachedProperties">
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="{StaticResource SpacingL}"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <TextBlock Grid.Row="0"
               Text="{DynamicResource Section.Filters}"
               Style="{StaticResource SectionHeader}"
               Margin="0,0,0,8"/>

    <Border Grid.Row="1"
            Style="{StaticResource SurfaceCard}"
            Padding="{StaticResource SpacingAllM}">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="{StaticResource SpacingM}"/>
          <ColumnDefinition Width="120"/>
          <ColumnDefinition Width="{StaticResource SpacingL}"/>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="{StaticResource SpacingM}"/>
          <ColumnDefinition Width="120"/>
          <ColumnDefinition Width="{StaticResource SpacingL}"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <Label Grid.Column="0"
               Content="{DynamicResource Platform}"
               VerticalAlignment="Center"/>
        <ComboBox x:Name="HistoryPlatformFilterComboBox"
                  Grid.Column="2"
                  SelectionChanged="HistoryFilter_Changed">
          <ComboBoxItem Content="{DynamicResource Common.All}"
                        IsSelected="True"/>
          <ComboBoxItem Content="{DynamicResource Platform.YouTube}"
                        Tag="{x:Static core:PlatformType.YouTube}"/>
        </ComboBox>

        <Label Grid.Column="4"
               Content="{DynamicResource History.Filter.Status}"
               VerticalAlignment="Center"/>
        <ComboBox x:Name="HistoryStatusFilterComboBox"
                  Grid.Column="6"
                  SelectionChanged="HistoryFilter_Changed">
          <ComboBoxItem Content="{DynamicResource History.Filter.All}"
                        IsSelected="True"/>
          <ComboBoxItem Content="{DynamicResource History.Success}"
                        Tag="Success"/>
          <ComboBoxItem Content="{DynamicResource History.Error}"
                        Tag="Error"/>
        </ComboBox>

        <Button Grid.Column="8"
                Content="Filter zuruecksetzen"
                Click="HistoryResetFilters_Click"
                ap:ButtonIcon.Glyph="&#xe5d5;"
                Style="{StaticResource SecondaryButton}"
                Background="Transparent"
                BorderThickness="0"
                Padding="0"
                FontSize="{StaticResource FontSizeS}"
                Foreground="{StaticResource PrimaryBrush}"
                Cursor="Hand"
                VerticalAlignment="Center"/>

      </Grid>
    </Border>

    <TextBlock Grid.Row="3"
               Text="{DynamicResource Section.HistoryList}"
               Style="{StaticResource SectionHeader}"
               Margin="0,0,0,8"/>

    <Border Grid.Row="4"
            Style="{StaticResource SurfaceCard}"
            Padding="1">
      <DataGrid x:Name="HistoryDataGrid"
                AutoGenerateColumns="False"
                IsReadOnly="True"
                CanUserAddRows="False"
                HeadersVisibility="Column"
                SelectionMode="Single"
                EnableRowVirtualization="True"
                EnableColumnVirtualization="True"
                VirtualizingPanel.IsVirtualizing="True"
                VirtualizingPanel.VirtualizationMode="Recycling"
                ScrollViewer.CanContentScroll="True"
                MouseDoubleClick="HistoryDataGrid_MouseDoubleClick">
        <DataGrid.Columns>
          <DataGridTextColumn Header="{DynamicResource History.List.DateTime}"
                              Binding="{Binding DateTime, StringFormat=G}"
                              Width="140"/>
          <DataGridTextColumn Header="{DynamicResource Common.Platform}"
                              Binding="{Binding Platform}"
                              Width="80"/>
          <DataGridTextColumn Header="{DynamicResource History.List.Title}"
                              Binding="{Binding VideoTitle}"
                              Width="*"/>
          <DataGridTextColumn Header="{DynamicResource Common.Status}"
                              Binding="{Binding Status}"
                              Width="70"/>
          <DataGridTemplateColumn Header="{DynamicResource History.List.Link}"
                                  Width="180">
            <DataGridTemplateColumn.CellTemplate>
              <DataTemplate>
                <TextBlock TextTrimming="CharacterEllipsis"
                           ToolTip="{Binding VideoUrl}">
                  <Hyperlink NavigateUri="{Binding VideoUrl}"
                             RequestNavigate="OpenUrlInBrowser">
                    <Run Text="{DynamicResource Common.Open}"/>
                  </Hyperlink>
                </TextBlock>
              </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
          </DataGridTemplateColumn>
        </DataGrid.Columns>
      </DataGrid>
    </Border>
  </Grid>
</UserControl>
