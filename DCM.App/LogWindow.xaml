<Window x:Class="DCM.App.LogWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ap="clr-namespace:DCM.App.Infrastructure.AttachedProperties"
        Title="{DynamicResource LogWindow.Title}"
        Height="500"
        Width="800"
        MinHeight="300"
        MinWidth="500"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource BackgroundBrush}">

  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="8"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="8"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Header mit Filter -->
    <Border Grid.Row="0"
            Style="{StaticResource Control.Container.SurfaceCard}"
            Padding="10,8">
      <DockPanel>
        <StackPanel Orientation="Horizontal"
            DockPanel.Dock="Left">
          <TextBlock Text="{DynamicResource LogWindow.FilterLabel}"
                     Foreground="{StaticResource TextMutedBrush}"
                     VerticalAlignment="Center"
                     Margin="0,0,8,0"/>
          <CheckBox x:Name="ShowDebugCheckBox"
                    Content="{DynamicResource LogWindow.Filter.Debug}"
                    Foreground="{StaticResource TextMutedBrush}"
                    IsChecked="False"
                    Margin="0,0,12,0"
                    Checked="Filter_Changed"
                    Unchecked="Filter_Changed"/>
          <CheckBox x:Name="ShowInfoCheckBox"
                    Content="{DynamicResource LogWindow.Filter.Info}"
                    Foreground="{StaticResource SuccessBrush}"
                    IsChecked="True"
                    Margin="0,0,12,0"
                    Checked="Filter_Changed"
                    Unchecked="Filter_Changed"/>
          <CheckBox x:Name="ShowWarningCheckBox"
                    Content="{DynamicResource LogWindow.Filter.Warning}"
                    Foreground="{StaticResource WarningBrush}"
                    IsChecked="True"
                    Margin="0,0,12,0"
                    Checked="Filter_Changed"
                    Unchecked="Filter_Changed"/>
          <CheckBox x:Name="ShowErrorCheckBox"
                    Content="{DynamicResource LogWindow.Filter.Error}"
                    Foreground="{StaticResource DangerBrush}"
                    IsChecked="True"
                    Checked="Filter_Changed"
                    Unchecked="Filter_Changed"/>
        </StackPanel>

        <StackPanel Orientation="Horizontal"
            DockPanel.Dock="Right"
            HorizontalAlignment="Right">
          <TextBlock x:Name="EntryCountText"
                     Foreground="{StaticResource TextMutedBrush}"
                     VerticalAlignment="Center"
                     Margin="0,0,12,0"
                     Text="{DynamicResource LogWindow.EntryCountPlaceholder}"/>
          <CheckBox x:Name="AutoScrollCheckBox"
                    Content="{DynamicResource LogWindow.AutoScroll}"
                    Foreground="{StaticResource TextMutedBrush}"
                    IsChecked="True"/>
        </StackPanel>
      </DockPanel>
    </Border>

    <!-- Log-Liste -->
    <Border Grid.Row="2"
            Style="{StaticResource Control.Container.SurfaceCard}"
            Padding="0">
      <ListBox x:Name="LogListBox"
               Background="Transparent"
               BorderThickness="0"
               VirtualizingPanel.IsVirtualizing="True"
               VirtualizingPanel.VirtualizationMode="Recycling"
               ScrollViewer.HorizontalScrollBarVisibility="Auto">
        <ListBox.ItemTemplate>
          <DataTemplate>
            <TextBlock Text="{Binding FormattedMessage}"
                       FontFamily="{StaticResource LogFont}"
                       FontSize="{StaticResource FontSizeS}"
                       Padding="4,2"
                       TextWrapping="NoWrap">
              <TextBlock.Style>
                <Style TargetType="TextBlock">
                  <Setter Property="Foreground"
                      Value="{StaticResource TextPrimaryBrush}"/>
                  <Style.Triggers>
                    <DataTrigger Binding="{Binding Level}"
                        Value="Debug">
                      <Setter Property="Foreground"
                          Value="{StaticResource TextMutedBrush}"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding Level}"
                        Value="Info">
                      <Setter Property="Foreground"
                          Value="{StaticResource TextPrimaryBrush}"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding Level}"
                        Value="Warning">
                      <Setter Property="Foreground"
                          Value="{StaticResource WarningBrush}"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding Level}"
                        Value="Error">
                      <Setter Property="Foreground"
                          Value="{StaticResource DangerBrush}"/>
                    </DataTrigger>
                  </Style.Triggers>
                </Style>
              </TextBlock.Style>
            </TextBlock>
          </DataTemplate>
        </ListBox.ItemTemplate>
        <ListBox.ItemContainerStyle>
          <Style TargetType="ListBoxItem">
            <Setter Property="Padding"
                Value="0"/>
            <Setter Property="Margin"
                Value="0"/>
            <Setter Property="HorizontalContentAlignment"
                Value="Stretch"/>
            <Setter Property="Background"
                Value="Transparent"/>
            <Setter Property="Template">
              <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                  <Border Background="{TemplateBinding Background}"
                          BorderThickness="0">
                    <ContentPresenter/>
                  </Border>
                  <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver"
                        Value="True">
                      <Setter Property="Background"
                          Value="{StaticResource SurfaceHoverBrush}"/>
                    </Trigger>
                  </ControlTemplate.Triggers>
                </ControlTemplate>
              </Setter.Value>
            </Setter>
          </Style>
        </ListBox.ItemContainerStyle>
      </ListBox>
    </Border>

    <!-- Footer mit Buttons -->
    <Border Grid.Row="4"
            Style="{StaticResource Control.Container.SurfaceCard}"
            Padding="10,8">
      <DockPanel>
        <StackPanel Orientation="Horizontal"
            DockPanel.Dock="Left">
          <Button x:Name="ClearButton"
                  Content="{DynamicResource LogWindow.Clear}"
                  ap:ButtonIcon.Glyph="&#xe872;"
                  Click="ClearButton_Click"
                  Style="{StaticResource Control.Button.Secondary}"
                  Margin="0,0,8,0"/>
          <Button x:Name="OpenLogFileButton"
                  Content="{DynamicResource LogWindow.OpenFile}"
                  ap:ButtonIcon.Glyph="&#xe89e;"
                  Click="OpenLogFileButton_Click"
                  Style="{StaticResource Control.Button.Secondary}"/>
        </StackPanel>

        <Button x:Name="CloseButton"
                Content="{DynamicResource Common.Close}"
                ap:ButtonIcon.Glyph="&#xe5cd;"
                Click="CloseButton_Click"
                DockPanel.Dock="Right"
                HorizontalAlignment="Right"
                Style="{StaticResource Control.Button.Primary}"/>
      </DockPanel>
    </Border>
  </Grid>
</Window>
